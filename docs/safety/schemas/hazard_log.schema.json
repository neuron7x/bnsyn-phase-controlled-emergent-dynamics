{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "BN-Syn Hazard Log",
  "type": "object",
  "required": ["version", "system", "hazards"],
  "properties": {
    "version": {"type": "string"},
    "system": {"type": "string"},
    "hazards": {
      "type": "array",
      "minItems": 1,
      "items": {
        "type": "object",
        "required": [
          "id",
          "title",
          "description",
          "severity",
          "losses",
          "unsafe_control_actions",
          "safety_constraints",
          "mitigations",
          "verification"
        ],
        "properties": {
          "id": {"type": "string", "pattern": "^H-\\d{3}$"},
          "title": {"type": "string"},
          "description": {"type": "string"},
          "severity": {"type": "string", "enum": ["low", "medium", "high", "critical"]},
          "losses": {"type": "array", "minItems": 1, "items": {"type": "string"}},
          "unsafe_control_actions": {"type": "array", "minItems": 1, "items": {"type": "string"}},
          "safety_constraints": {"type": "array", "minItems": 1, "items": {"type": "string", "pattern": "^SC-\\d{3}$"}},
          "mitigations": {"type": "array", "minItems": 1, "items": {"type": "string"}},
          "verification": {"type": "array", "minItems": 1, "items": {"type": "string"}}
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}

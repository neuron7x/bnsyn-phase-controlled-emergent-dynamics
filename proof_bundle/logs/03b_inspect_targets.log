$ rg -n "^test:|^test-gate:|^test-validation:|^test-property:|pytest --collect-only|ci-pr-atomic|validate-calibration|calibration" Makefile .github/workflows/ci-pr-atomic.yml docs/TESTING.md README.md claims docs -g "*.md" -g "Makefile" -g "*.yml" -g "*.yaml"
claims/claims.yml:292:    calibration of response curves.
claims/claims.yml:299:  notes: Grounds deterministic f–I calibration utilities.
claims/claims.yml:303:  - src/bnsyn/calibration/fit.py
claims/claims.yml:305:  - tests/test_calibration_smoke.py
claims/claims.yml:306:  - tests/validation/test_calibration_validation.py
Makefile:40:test:
Makefile:46:test-validation:
docs/ENFORCEMENT_MATRIX.md:11:| Build must be installable | AGENTS.md, .github/workflows/ci-pr-atomic.yml | package build gate | `python -m build` | non-zero exit from build |
docs/_inventory.md:10:- calibration_pack
docs/_inventory.md:43:- .github/workflows/ci-pr-atomic.yml
docs/EVIDENCE_COVERAGE.md:20:| CLM-0024 | Tier-A | true | PROVEN | bjorck1996least | 10.1137/1.9781611971484 | P2-10 Calibration utilities | `src/bnsyn/calibration/fit.py` | `tests/test_calibration_smoke.py`, `tests/validation/test_calibration_validation.py` |
docs/SPEC.md:4:It is structured as **12 components** with: (a) equations, (b) calibration knobs, (c) failure envelopes,
docs/SPEC.md:27:| P2-10 | Calibration utilities (f–I fit) | `bnsyn/calibration/fit.py` | `test_calibration_smoke.py` |
docs/scripts/validate-pr-gates.md:14:- `ci-pr-atomic.yml`
docs/CI_BATTLE_USAGE_AUDIT_2026-02-07.md:9:   - `.github/workflows/ci-pr-atomic.yml`
docs/CI_BATTLE_USAGE_AUDIT_2026-02-07.md:15:3. Current HEAD run query evidence is exported in `artifacts/audit/runs_for_head.json`; required workflows are recorded as success for `ci-pr-atomic`, `Workflow Integrity`, `Math Quality Gate`, and `dependency-review=NOT_TRIGGERED (path filter)`.
docs/scripts/collect-ci-run-urls.md:11:- `.github/workflows/ci-pr-atomic.yml`
docs/CI_GATES.md:90:1. Open GitHub Actions run for `ci-pr-atomic` or `ci-smoke`.
docs/TRACEABILITY_MAP.md:7:| Reject malformed external numeric inputs (shape/dtype/non-finite) | Prevent undefined numerical state propagation | `src/bnsyn/validation/inputs.py` | `tests/test_validation_inputs.py` | `ci-pr-atomic` → `tests-smoke` |
docs/TRACEABILITY_MAP.md:8:| Enforce admissible simulation grid (`dt_ms`, duration multiple) | Prevent unstable/undefined integration schedules | `src/bnsyn/schemas/experiment.py` | `tests/test_schema_experiment_contracts.py` | `ci-pr-atomic` → `tests-smoke` |
docs/TRACEABILITY_MAP.md:9:| Wake-cycle API must reject invalid recording cadence | Prevent silent memory-capture corruption | `src/bnsyn/sleep/cycle.py` | `tests/test_sleep_cycle.py` | `ci-pr-atomic` → `tests-smoke` |
docs/TRACEABILITY_MAP.md:10:| Provenance generation must be deterministic without git availability | Preserve auditability in non-git execution contexts | `src/bnsyn/provenance/manifest_builder.py` | `tests/test_manifest_builder.py` | `ci-pr-atomic` → `tests-smoke` |
docs/TRACEABILITY_MAP.md:11:| Coverage must not regress below baseline/floor | Prevent quality drift | `scripts/check_coverage_gate.py`, `quality/coverage_gate.json` | `make coverage-gate` execution path | `ci-pr-atomic` reusable pytest + local gate command |
docs/appendix/EXECUTIVE_SUMMARY.md:15:- ✅ **Formal specification:** 12-component SPEC with equations + calibration + failure envelopes
docs/appendix/CODEX_PROJECT_FEEDBACK_UA.md:14:- `.github/workflows/ci-pr-atomic.yml` — PR SSOT gate з `make api-contract`.
README.md:12:[![Atomic PR Gate](https://github.com/neuron7x/bnsyn-phase-controlled-emergent-dynamics/actions/workflows/ci-pr-atomic.yml/badge.svg)](https://github.com/neuron7x/bnsyn-phase-controlled-emergent-dynamics/actions/workflows/ci-pr-atomic.yml)
.github/workflows/ci-pr-atomic.yml:1:name: ci-pr-atomic
.github/workflows/ci-pr-atomic.yml:32:  group: ci-pr-atomic-${{ github.ref }}
.github/workflows/ci-pr-atomic.yml:510:          cat > artifacts/ci-evidence/ci-pr-atomic-${{ github.sha }}.json <<'JSON'
.github/workflows/ci-pr-atomic.yml:512:            "workflow": "ci-pr-atomic",
.github/workflows/ci-pr-atomic.yml:525:          name: ci-evidence-ci-pr-atomic-${{ github.sha }}
.github/workflows/ci-pr-atomic.yml:526:          path: artifacts/ci-evidence/ci-pr-atomic-${{ github.sha }}.json
docs/PLACEHOLDER_REGISTRY.md:10:- CI workflow: `.github/workflows/ci-pr-atomic.yml`
docs/COMPONENT_AUDIT.md:14:| P2-10 | P2-10 | VERIFIED | src/bnsyn/calibration/fit.py | tests/test_calibration_smoke.py; tests/validation/test_calibration_validation.py | CLM-0024 | Deterministic least-squares fit validated. |
docs/spec_to_code.yml:95:    - src/bnsyn/calibration/fit.py
docs/spec_to_code.yml:97:    - tests/test_calibration_smoke.py
docs/spec_to_code.yml:98:    - tests/validation/test_calibration_validation.py
docs/ENTROPY_LEDGER.md:13:- BUILD_CMD: `python -m build` (from `.github/workflows/ci-pr-atomic.yml`)
docs/ENTROPY_LEDGER.md:14:- SCAN_CMD: `python -m scripts.scan_governed_docs` (from `.github/workflows/ci-pr-atomic.yml`)
docs/math/MATH_SURFACES.md:7:- Component model surfaces explicitly defined by SPEC: AdEx neuron dynamics (P0-1), conductance synapses (P0-2), three-factor learning (P0-3), criticality control (P0-4), temperature gating (P1-5), consolidation (P1-6), energy regularization (P1-7), numerical methods (P2-8), determinism protocol (P2-9), calibration (P2-10), reference network simulator (P2-11), bench harness (P2-12).
$ find .github/workflows -maxdepth 1 -type f -name "*.yml" -print
.github/workflows/science.yml
.github/workflows/release-pipeline.yml
.github/workflows/docs.yml
.github/workflows/codeql.yml
.github/workflows/ci-validation.yml
.github/workflows/_reusable_benchmarks.yml
.github/workflows/_reusable_formal_science.yml
.github/workflows/_reusable_chaos_tests.yml
.github/workflows/ci-pr-atomic.yml
.github/workflows/workflow-integrity.yml
.github/workflows/_reusable_quality.yml
.github/workflows/ci-smoke.yml
.github/workflows/physics-equivalence.yml
.github/workflows/quality-mutation.yml
.github/workflows/ci-benchmarks-elite.yml
.github/workflows/_reusable_gate_profile.yml
.github/workflows/math-quality-gate.yml
.github/workflows/dependency-review.yml
.github/workflows/dependency-watch.yml
.github/workflows/formal-coq.yml
.github/workflows/formal-tla.yml
.github/workflows/_reusable_ssot.yml
.github/workflows/_reusable_property_tests.yml
.github/workflows/ci-pr.yml
.github/workflows/codecov-health.yml
.github/workflows/benchmarks.yml
.github/workflows/ci-benchmarks.yml
.github/workflows/_reusable_pytest.yml
.github/workflows/_reusable_validation_tests.yml
$ sed -n "1,260p" .github/workflows/ci-pr-atomic.yml
name: ci-pr-atomic

on:
  pull_request:
    types: [opened, synchronize, reopened, labeled, unlabeled, edited]
  push:
    branches: [main]
  workflow_dispatch:
    inputs:
      python-version:
        type: string
        default: "3.11"
      upload-codecov:
        type: boolean
        default: true
  workflow_call:
    inputs:
      python-version:
        type: string
        default: "3.11"
      upload-codecov:
        type: boolean
        default: true
    secrets:
      CODECOV_TOKEN:
        required: false

permissions:
  contents: read

concurrency:
  group: ci-pr-atomic-${{ github.ref }}
  cancel-in-progress: true

env:
  PIP_CACHE_DIR: ~/.cache/pip
  PYTHONHASHSEED: 0
  PYTHONDONTWRITEBYTECODE: 1
  PIP_DISABLE_PIP_VERSION_CHECK: 1
  PIP_NO_PYTHON_VERSION_WARNING: 1

jobs:
  changes:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: read
    outputs:
      code: ${{ steps.filter.outputs.code }}
      validation: ${{ steps.filter.outputs.validation }}
      property: ${{ steps.filter.outputs.property }}
      docs: ${{ steps.filter.outputs.docs }}
      dependency_manifest: ${{ steps.filter.outputs.dependency_manifest }}
    steps:
      - uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5
      - uses: dorny/paths-filter@de90cc6fb38fc0963ad72b210f1f284cd68cea36
        id: filter
        with:
          filters: |
            code:
              - 'src/**'
              - 'tests/**'
            validation:
              - 'src/**'
              - 'tools/**'
              - 'scripts/**'
              - 'docs/**'
              - 'tests/**'
            property:
              - 'src/**'
              - 'tests/**'
            docs:
              - 'docs/**'
              - 'README*'
              - 'mkdocs.yml'
              - 'pyproject.toml'
            dependency_manifest:
              - 'pyproject.toml'
              - 'requirements*.txt'

  gate-profile:
    permissions:
      contents: read
    uses: ./.github/workflows/_reusable_gate_profile.yml
    with:
      profile: pr

  determinism:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    timeout-minutes: 20
    steps:
      - uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5
      - uses: actions/setup-python@a26af69be951a213d495a4c3e4e4022e16d87065
        with:
          python-version: ${{ inputs['python-version'] || '3.11' }}
          cache: "pip"
          cache-dependency-path: |
            pyproject.toml
            requirements-lock.txt
      - name: Pin pip
        uses: ./.github/actions/pin-pip
      - name: Log pip version
        run: python -m pip --version
      - run: python -m pip install -e ".[dev,test]"
      - name: Test determinism (run 1)
        id: run1
        run: pytest tests/test_determinism.py tests/properties/test_properties_determinism.py -v --tb=short
      - name: Test determinism (run 2)
        id: run2
        run: pytest tests/test_determinism.py tests/properties/test_properties_determinism.py -v --tb=short
      - name: Test determinism (run 3)
        id: run3
        run: pytest tests/test_determinism.py tests/properties/test_properties_determinism.py -v --tb=short
      - name: Check RNG isolation
        id: rng
        run: pytest tests/test_determinism.py::test_no_global_numpy_rng_usage -v
      - name: Generate summary
        if: always()
        run: |
          summary_file="$GITHUB_STEP_SUMMARY"
          {
            echo "##  Determinism Verification (3x Runs)"
            echo ""
            echo "| Run | Status | Result |"
            echo "|-----|--------|--------|"
            if [ "${{ steps.run1.outcome }}" = "success" ]; then
              echo "| 1 |  PASS | Identical outputs |"
            else
              echo "| 1 |  FAIL | Non-deterministic |"
            fi
            if [ "${{ steps.run2.outcome }}" = "success" ]; then
              echo "| 2 |  PASS | Identical outputs |"
            else
              echo "| 2 |  FAIL | Non-deterministic |"
            fi
            if [ "${{ steps.run3.outcome }}" = "success" ]; then
              echo "| 3 |  PASS | Identical outputs |"
            else
              echo "| 3 |  FAIL | Non-deterministic |"
            fi
            echo ""
            echo "| Check | Status |"
            echo "|-------|--------|"
            if [ "${{ steps.rng.outcome }}" = "success" ]; then
              echo "| RNG Isolation |  PASS |"
            else
              echo "| RNG Isolation |  FAIL |"
            fi
            echo ""
            if [ "${{ steps.run1.outcome }}" = "success" ] && [ "${{ steps.run2.outcome }}" = "success" ] && [ "${{ steps.run3.outcome }}" = "success" ]; then
              echo "** All runs produced identical outputs (A1: Determinism 96%)**"
            else
              echo "** Determinism check failed**"
            fi
          } >> "$summary_file"


  contracts:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    timeout-minutes: 12
    steps:
      - uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5
      - uses: actions/setup-python@a26af69be951a213d495a4c3e4e4022e16d87065
        with:
          python-version: ${{ inputs['python-version'] || '3.11' }}
          cache: "pip"
      - name: Pin pip
        uses: ./.github/actions/pin-pip
      - name: Log pip version
        run: python -m pip --version
      - run: python -m pip install -e ".[test]"
      - name: Validate traceability table
        run: python -m scripts.validate_traceability
      - name: Check internal docs links
        run: python -m scripts.check_internal_links
      - name: Run no-escape contract tests
        run: |
          pytest -q             tests/test_actions_pinning.py             tests/test_no_escape_tripwires.py             tests/test_schema_contracts.py             tests/test_verify_reproducible_artifacts.py
      - name: Verify reproducible generated artifacts
        run: |
          python -m scripts.verify_reproducible_artifacts             --spec evidence/zqsg_2026_02_12/repro_spec.json             --runs 3             --report evidence/zqsg_2026_02_12/repro_report_ci.json
      - name: Upload contract artifacts
        if: always()
        uses: actions/upload-artifact@ea165f8d65b6e75b540449e92b4886f43607fa02
        with:
          name: no-escape-contracts-${{ github.sha }}
          path: |
            evidence/zqsg_2026_02_12/repro_report_ci.json
          if-no-files-found: error
          retention-days: 30

  quality:
    permissions:
      contents: read
    uses: ./.github/workflows/_reusable_quality.yml
    with:
      python-version: ${{ inputs['python-version'] || '3.11' }}
      mypy-strict: true
      pylint-threshold: 7.5

  build:
    runs-on: ubuntu-latest
    permissions:
      contents: read
    timeout-minutes: 20
    steps:
      - uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5
      - uses: actions/setup-python@a26af69be951a213d495a4c3e4e4022e16d87065
        with:
          python-version: ${{ inputs['python-version'] || '3.11' }}
          cache: "pip"
          cache-dependency-path: |
            pyproject.toml
            requirements-lock.txt
      - name: Pin pip
        uses: ./.github/actions/pin-pip
      - name: Log pip version
        run: python -m pip --version
      - run: python -m pip install -e ".[dev,test]" build
      - name: Verify lockfile freshness
        run: |
          python -m pip install pip-tools
          PYENV_VERSION=3.11.14 pip-compile --extra=dev --generate-hashes --output-file=requirements-lock.txt pyproject.toml
          git diff --exit-code -- requirements-lock.txt
      - run: python -m build
      - name: Install from wheel in clean venv
        run: |
          python -m venv .venv-wheel
          . .venv-wheel/bin/activate
          python -m pip install --upgrade pip
          python -m pip install dist/*.whl
          python -c "import bnsyn; print(bnsyn.__version__)"

  smoke-wheel-matrix:
    name: smoke-wheel-matrix (py${{ matrix.python-version }})
    runs-on: ubuntu-latest
    permissions:
      contents: read
    timeout-minutes: 30
    strategy:
      fail-fast: false
      matrix:
        python-version: ["3.11", "3.12"]
    steps:
      - uses: actions/checkout@34e114876b0b11c390a56381ad16ebd13914f8d5
      - uses: actions/setup-python@a26af69be951a213d495a4c3e4e4022e16d87065
        with:
          python-version: ${{ matrix.python-version }}
          cache: "pip"
      - name: Pin pip
        uses: ./.github/actions/pin-pip
      - name: Log pip version
        run: python -m pip --version
      - run: python -m pip install -e ".[dev,test]" build
      - name: Smoke tests
        run: pytest -m smoke -v --tb=short

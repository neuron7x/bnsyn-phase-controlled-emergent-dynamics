# DEPRECATED: compatibility shim; remove after protection update
name: benchmarks

on:
  pull_request:
  workflow_dispatch:
    inputs:
      tier:
        description: "Benchmark tier to run"
        required: true
        type: choice
        default: standard
        options:
          - standard
          - elite
      profile:
        description: "Benchmark profile to run"
        required: true
        type: choice
        default: baseline
        options:
          - micro
          - baseline
          - full
          - custom
      scenario:
        description: "Benchmark scenario to run (custom profile only)"
        required: false
        default: ci_smoke
        type: choice
        options:
          - ci_smoke
          - quick
          - n_sweep
          - steps_sweep
          - conn_sweep
          - dt_sweep
  schedule:
    - cron: '0 2 * * *'
    - cron: '0 0 * * 1'
    - cron: '0 3 * * 0'

permissions:
  contents: read

jobs:
  benchmarks-pr:
    if: ${{ github.event_name == 'pull_request' }}
    uses: ./.github/workflows/ci-benchmarks.yml
    with:
      tier: standard
      profile: micro
      scenario: ci_smoke
    secrets: inherit

  benchmarks-dispatch:
    if: ${{ github.event_name == 'workflow_dispatch' }}
    uses: ./.github/workflows/ci-benchmarks.yml
    with:
      tier: ${{ inputs.tier }}
      profile: ${{ inputs.profile }}
      scenario: ${{ inputs.scenario }}
    secrets: inherit

  benchmarks-standard:
    if: ${{ github.event_name == 'schedule' && github.event.schedule == '0 2 * * *' }}
    uses: ./.github/workflows/ci-benchmarks.yml
    with:
      tier: standard
      profile: baseline
      scenario: ci_smoke
    secrets: inherit

  benchmarks-weekly-scenario:
    if: ${{ github.event_name == 'schedule' && github.event.schedule == '0 0 * * 1' }}
    uses: ./.github/workflows/ci-benchmarks.yml
    with:
      tier: standard
      profile: custom
      scenario: ci_smoke
    secrets: inherit

  benchmarks-elite:
    if: ${{ github.event_name == 'schedule' && github.event.schedule == '0 3 * * 0' }}
    uses: ./.github/workflows/ci-benchmarks.yml
    with:
      tier: elite
      profile: baseline
      scenario: ci_smoke
    secrets: inherit

scpe_release: v1.0
schema_version: GM-2026.1
owner: codex-interpreted-mechanized-quality-agent
gates:
  - id: "G.SEC.001"
    description: "Security redaction policy exists."
    pass_predicate: "SECURITY.redaction.yml exists"
    evidence_commands: ["test -f SECURITY.redaction.yml && echo ok"]
    required_artifacts: ["SECURITY.redaction.yml"]
    runtime_budget_seconds: 10
    rollback_hint: "add policy file"
    owner: "codex-interpreted-mechanized-quality-agent"

  - id: "G.IM.001"
    description: "Interpreter outputs parseable interpretation.json with required fields."
    pass_predicate: "REPORTS/interpretation.json exists AND schema_valid=true"
    evidence_commands: ["python3 tools/validate_interpretation.py REPORTS/interpretation.json"]
    required_artifacts: ["REPORTS/interpretation.json", "REPORTS/interpretation.schema-check.json"]
    runtime_budget_seconds: 60
    rollback_hint: "instrument-only"
    owner: "codex-interpreted-mechanized-quality-agent"

  - id: "G.QM.001"
    description: "Quality baseline reports exist for all configured dimensions."
    pass_predicate: "REPORTS/quality-baseline.json exists AND all required report files exist"
    evidence_commands: ["python3 tools/validate_quality_reports.py QM.yml"]
    required_artifacts:
      - "REPORTS/quality-baseline.json"
      - "REPORTS/quality/lint.json"
      - "REPORTS/quality/tests.json"
      - "REPORTS/quality/security.json"
      - "REPORTS/quality/maintainability.json"
      - "REPORTS/quality/docs.json"
      - "REPORTS/quality/perf.json"
    runtime_budget_seconds: 180
    rollback_hint: "instrument-only"
    owner: "codex-interpreted-mechanized-quality-agent"

  - id: "G.QM.010"
    description: "Hard blockers satisfied: lint/tests/security pass."
    pass_predicate: "lint.error_count==0 AND tests.fail_count==0 AND security.high_count==0"
    evidence_commands: ["python3 tools/score_quality.py QM.yml --out REPORTS/scorecard.json"]
    required_artifacts: ["REPORTS/scorecard.json"]
    runtime_budget_seconds: 120
    rollback_hint: "revert changes"
    owner: "codex-interpreted-mechanized-quality-agent"

  - id: "G.QM.020"
    description: "Maintainability thresholds satisfied."
    pass_predicate: "complexity.p95<=complexity.p95_max AND duplication.lines<=duplication.max_lines"
    evidence_commands: ["python3 tools/score_quality.py QM.yml --out REPORTS/scorecard.json"]
    required_artifacts: ["REPORTS/scorecard.json"]
    runtime_budget_seconds: 120
    rollback_hint: "revert changes"
    owner: "codex-interpreted-mechanized-quality-agent"

  - id: "G.QM.030"
    description: "Docs quality satisfied."
    pass_predicate: "docs.broken_links==0"
    evidence_commands: ["python3 tools/score_quality.py QM.yml --out REPORTS/scorecard.json"]
    required_artifacts: ["REPORTS/scorecard.json"]
    runtime_budget_seconds: 120
    rollback_hint: "revert changes"
    owner: "codex-interpreted-mechanized-quality-agent"

  - id: "G.QM.040"
    description: "Performance regression absent."
    pass_predicate: "perf.regression_detected==false"
    evidence_commands: ["python3 tools/score_quality.py QM.yml --out REPORTS/scorecard.json"]
    required_artifacts: ["REPORTS/scorecard.json"]
    runtime_budget_seconds: 120
    rollback_hint: "revert changes"
    owner: "codex-interpreted-mechanized-quality-agent"

  - id: "G.QM.050"
    description: "Composite quality score meets threshold."
    pass_predicate: "score>=min_score"
    evidence_commands: ["python3 tools/score_quality.py QM.yml --out REPORTS/scorecard.json"]
    required_artifacts: ["REPORTS/scorecard.json"]
    runtime_budget_seconds: 120
    rollback_hint: "revert changes"
    owner: "codex-interpreted-mechanized-quality-agent"

  - id: "G.CDX.PR.001"
    description: "Single PR exists or updated with gate-referenced commits."
    pass_predicate: "REPORTS/pr.json exists AND pr.url exists"
    evidence_commands: ["gh pr view \"$PR_NUMBER\" --json url,number,baseRefName,headRefName,commits > REPORTS/pr.json"]
    required_artifacts: ["REPORTS/pr.json"]
    runtime_budget_seconds: 180
    rollback_hint: "close PR"
    owner: "codex-interpreted-mechanized-quality-agent"

  - id: "G.CDX.CI.001"
    description: "CI run URLs captured for head SHA and checks recorded."
    pass_predicate: "REPORTS/ci-after.json exists AND REPORTS/checks.json exists"
    evidence_commands:
      - "gh pr view \"$PR_NUMBER\" --json headRefOid > REPORTS/pr-head.json"
      - "gh api \"repos/$REPO/commits/$HEAD_SHA/check-runs\" > REPORTS/checks.json"
      - "gh api \"repos/$REPO/actions/runs?branch=$HEAD_BRANCH&per_page=10\" > REPORTS/ci-after.json"
    required_artifacts: ["REPORTS/ci-after.json", "REPORTS/checks.json"]
    runtime_budget_seconds: 900
    rollback_hint: "iterate"
    owner: "codex-interpreted-mechanized-quality-agent"

  - id: "G.EBS.001"
    description: "EBS-2026 proof bundle exists with MANIFEST.json sha256 for required artifacts."
    pass_predicate: "MANIFEST.json exists AND artifacts sha256 complete AND commands exit codes recorded"
    evidence_commands: ["python3 tools/make_manifest.py --evidence-root \"$EVIDENCE_ROOT\" --git-sha-before \"$GIT_BEFORE\" --git-sha-after \"$GIT_AFTER\" --out \"$EVIDENCE_ROOT/MANIFEST.json\""]
    required_artifacts: ["ENV.txt", "COMMANDS.txt", "MANIFEST.json", "BASELINE/", "AFTER/", "REPORTS/"]
    runtime_budget_seconds: 120
    rollback_hint: "revert-safe"
    owner: "codex-interpreted-mechanized-quality-agent"

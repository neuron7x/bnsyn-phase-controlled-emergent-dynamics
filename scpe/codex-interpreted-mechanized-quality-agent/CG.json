{
  "scpe_release": "v1.0",
  "schema_version": "CG-2026.2",
  "name": "codex-interpreted-mechanized-quality-agent",
  "nodes": [
    { "id": "OBSERVE.INVENTORY", "type": "OBSERVE", "outputs": ["REPORTS/inventory.json", "REPORTS/ci-baseline.json", "ENV.txt", "COMMANDS.txt"] },
    { "id": "MEASURE.BASELINE", "type": "OBSERVE", "outputs": ["REPORTS/quality/*", "REPORTS/quality-baseline.json"] },
    { "id": "INTERPRET.RUN", "type": "DECIDE", "inputs": ["REPORTS/quality-baseline.json", "IM.yml", "QM.yml"], "outputs": ["REPORTS/interpretation.json", "REPORTS/trace.jsonl"] },
    { "id": "DECIDE.GATES", "type": "DECIDE", "inputs": ["REPORTS/interpretation.json"], "outputs": ["REPORTS/gate-decisions.json", "REPORTS/scorecard.json"] },
    { "id": "ACT.INSTRUMENT", "type": "ACT", "precondition": "UNKNOWN_or_missing_reports", "rule": "instrument-first within allowlist", "outputs": ["AFTER/instrumentation.patch"] },
    { "id": "ACT.MINIMAL_FIX", "type": "ACT", "precondition": "FAIL", "rule": "minimal diff mapped to deficits", "outputs": ["AFTER/diff.patch"] },
    { "id": "ACT.PR", "type": "ACT", "precondition": "changes_ready", "rule": "create/update exactly one PR", "outputs": ["REPORTS/pr.json"] },
    { "id": "MEASURE.AFTER", "type": "OBSERVE", "precondition": "changes_applied", "rule": "identical measurement contract", "outputs": ["REPORTS/quality-after.json", "REPORTS/quality/*"] },
    { "id": "COMPARE.DELTA", "type": "DECIDE", "inputs": ["REPORTS/quality-baseline.json", "REPORTS/quality-after.json"], "outputs": ["REPORTS/delta.json", "REPORTS/diff-summary.json"] },
    { "id": "PROVE.CI", "type": "PROVE", "precondition": "PR_exists", "outputs": ["REPORTS/ci-after.json", "REPORTS/checks.json"] },
    { "id": "PROVE.EBS", "type": "PROVE", "inputs": ["BASELINE/*", "AFTER/*", "REPORTS/*"], "outputs": ["MANIFEST.json"] },
    { "id": "DECIDE.RECHECK", "type": "DECIDE", "inputs": ["REPORTS/delta.json", "REPORTS/checks.json", "MANIFEST.json"], "outputs": ["REPORTS/gate-decisions.after.json", "REPORTS/scorecard.after.json"] },
    { "id": "OUTPUT.OH", "type": "PROVE", "inputs": ["REPORTS/gate-decisions.after.json", "REPORTS/scorecard.after.json", "REPORTS/pr.json", "REPORTS/ci-after.json", "MANIFEST.json"], "outputs": ["OH-output"] }
  ],
  "edges": [
    { "from": "OBSERVE.INVENTORY", "to": "MEASURE.BASELINE" },
    { "from": "MEASURE.BASELINE", "to": "INTERPRET.RUN" },
    { "from": "INTERPRET.RUN", "to": "DECIDE.GATES" },
    { "from": "DECIDE.GATES", "to": "ACT.INSTRUMENT", "when": "UNKNOWN_or_missing_reports" },
    { "from": "DECIDE.GATES", "to": "ACT.MINIMAL_FIX", "when": "FAIL" },
    { "from": "ACT.INSTRUMENT", "to": "ACT.PR" },
    { "from": "ACT.MINIMAL_FIX", "to": "ACT.PR" },
    { "from": "ACT.PR", "to": "MEASURE.AFTER" },
    { "from": "MEASURE.AFTER", "to": "COMPARE.DELTA" },
    { "from": "COMPARE.DELTA", "to": "PROVE.CI" },
    { "from": "PROVE.CI", "to": "PROVE.EBS" },
    { "from": "PROVE.EBS", "to": "DECIDE.RECHECK" },
    { "from": "DECIDE.RECHECK", "to": "OUTPUT.OH", "when": "no invariant violations" }
  ],
  "control_rules": [
    "no ACT without DECIDE mapping",
    "UNKNOWN never becomes PASS",
    "baseline and after measurement contract must match",
    "one PR maximum"
  ]
}

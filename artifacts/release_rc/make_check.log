ruff format .
1 file reformatted, 237 files left unchanged
Formatted code
ruff check .
All checks passed!
pylint src/bnsyn
************* Module bnsyn.cli
src/bnsyn/cli.py:60:8: W0621: Redefining name 'Path' from outer scope (line 26) (redefined-outer-name)
src/bnsyn/cli.py:58:8: C0415: Import outside toplevel (subprocess) (import-outside-toplevel)
src/bnsyn/cli.py:59:8: C0415: Import outside toplevel (sys) (import-outside-toplevel)
src/bnsyn/cli.py:60:8: W0404: Reimport 'Path' (imported line 26) (reimported)
src/bnsyn/cli.py:60:8: C0415: Import outside toplevel (pathlib.Path) (import-outside-toplevel)
src/bnsyn/cli.py:71:12: W1510: 'subprocess.run' used without explicitly defining the value for 'check'. (subprocess-run-check)
src/bnsyn/cli.py:136:4: C0415: Import outside toplevel (bnsyn.experiments.declarative.run_from_yaml) (import-outside-toplevel)
src/bnsyn/cli.py:146:0: R0914: Too many local variables (57/15) (too-many-locals)
src/bnsyn/cli.py:170:4: C0415: Import outside toplevel (bnsyn.config.AdExParams, bnsyn.config.CriticalityParams, bnsyn.config.SynapseParams, bnsyn.config.TemperatureParams) (import-outside-toplevel)
src/bnsyn/cli.py:171:4: C0415: Import outside toplevel (bnsyn.criticality.PhaseTransitionDetector) (import-outside-toplevel)
src/bnsyn/cli.py:172:4: C0415: Import outside toplevel (bnsyn.emergence.AttractorCrystallizer) (import-outside-toplevel)
src/bnsyn/cli.py:173:4: C0415: Import outside toplevel (bnsyn.memory.MemoryConsolidator) (import-outside-toplevel)
src/bnsyn/cli.py:174:4: C0415: Import outside toplevel (bnsyn.rng.seed_all) (import-outside-toplevel)
src/bnsyn/cli.py:175:4: C0415: Import outside toplevel (bnsyn.sim.network.Network, bnsyn.sim.network.NetworkParams) (import-outside-toplevel)
src/bnsyn/cli.py:176:4: C0415: Import outside toplevel (bnsyn.sleep.SleepCycle, bnsyn.sleep.SleepStageConfig, bnsyn.sleep.default_human_sleep_cycle) (import-outside-toplevel)
src/bnsyn/cli.py:177:4: C0415: Import outside toplevel (bnsyn.temperature.schedule.TemperatureSchedule) (import-outside-toplevel)
src/bnsyn/cli.py:298:9: W1514: Using open without explicitly specifying an encoding (unspecified-encoding)
src/bnsyn/cli.py:313:9: W1514: Using open without explicitly specifying an encoding (unspecified-encoding)
src/bnsyn/cli.py:319:8: C0415: Import outside toplevel (matplotlib.pyplot) (import-outside-toplevel)
src/bnsyn/cli.py:320:8: W0404: Reimport 'Any' (imported line 27) (reimported)
src/bnsyn/cli.py:320:8: C0415: Import outside toplevel (typing.Any) (import-outside-toplevel)
src/bnsyn/cli.py:146:0: R0915: Too many statements (106/50) (too-many-statements)
src/bnsyn/cli.py:322:8: W0612: Unused variable 'fig' (unused-variable)
************* Module bnsyn.sleep.cycle
src/bnsyn/sleep/cycle.py:54:0: R0902: Too many instance attributes (10/7) (too-many-instance-attributes)
************* Module bnsyn.experiments.declarative
src/bnsyn/experiments/declarative.py:56:9: W1514: Using open without explicitly specifying an encoding (unspecified-encoding)
src/bnsyn/experiments/declarative.py:161:13: W1514: Using open without explicitly specifying an encoding (unspecified-encoding)
************* Module bnsyn.plasticity.three_factor
src/bnsyn/plasticity/three_factor.py:100:0: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)
************* Module bnsyn.production.connectivity
src/bnsyn/production/connectivity.py:86:0: C0325: Unnecessary parens after 'not' keyword (superfluous-parens)
************* Module bnsyn.production.adex
src/bnsyn/production/adex.py:35:0: R0902: Too many instance attributes (11/7) (too-many-instance-attributes)
************* Module bnsyn.production.jax_backend
src/bnsyn/production/jax_backend.py:48:0: R0914: Too many local variables (21/15) (too-many-locals)
************* Module bnsyn.calibration.accuracy_speed
src/bnsyn/calibration/accuracy_speed.py:37:0: R0902: Too many instance attributes (8/7) (too-many-instance-attributes)
src/bnsyn/calibration/accuracy_speed.py:79:0: R0914: Too many local variables (18/15) (too-many-locals)
************* Module bnsyn.emergence.crystallizer
src/bnsyn/emergence/crystallizer.py:126:0: R0902: Too many instance attributes (17/7) (too-many-instance-attributes)
src/bnsyn/emergence/crystallizer.py:290:12: W0107: Unnecessary pass statement (unnecessary-pass)
src/bnsyn/emergence/crystallizer.py:280:12: W0612: Unused variable 'U' (unused-variable)
src/bnsyn/emergence/crystallizer.py:280:15: W0612: Unused variable 'S' (unused-variable)
************* Module bnsyn.sim.network
src/bnsyn/sim/network.py:56:0: R0902: Too many instance attributes (9/7) (too-many-instance-attributes)
src/bnsyn/sim/network.py:98:0: R0902: Too many instance attributes (23/7) (too-many-instance-attributes)
src/bnsyn/sim/network.py:131:4: R0917: Too many positional arguments (8/5) (too-many-positional-arguments)
src/bnsyn/sim/network.py:131:4: R0914: Too many local variables (17/15) (too-many-locals)
src/bnsyn/sim/network.py:131:4: R0915: Too many statements (53/50) (too-many-statements)
src/bnsyn/sim/network.py:212:4: R0914: Too many local variables (21/15) (too-many-locals)
src/bnsyn/sim/network.py:329:4: R0914: Too many local variables (22/15) (too-many-locals)
src/bnsyn/sim/network.py:431:0: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)
src/bnsyn/sim/network.py:473:4: C0415: Import outside toplevel (bnsyn.rng.seed_all) (import-outside-toplevel)
************* Module bnsyn.testing.faults
src/bnsyn/testing/faults.py:39:0: R0903: Too few public methods (1/2) (too-few-public-methods)
src/bnsyn/testing/faults.py:179:18: W0613: Unused argument 'rng_state' (unused-argument)
src/bnsyn/testing/faults.py:234:8: R1720: Unnecessary "elif" after "raise", remove the leading "el" from "elif" (no-else-raise)
************* Module bnsyn.criticality.phase_transition
src/bnsyn/criticality/phase_transition.py:77:0: R0902: Too many instance attributes (9/7) (too-many-instance-attributes)
src/bnsyn/criticality/phase_transition.py:133:8: R1705: Unnecessary "elif" after "return", remove the leading "el" from "elif" (no-else-return)
src/bnsyn/criticality/phase_transition.py:167:11: R1714: Consider merging these comparisons with 'in' by using 'self._current_phase not in (new_phase, CriticalPhase.UNKNOWN)'. Use a set instead if elements are hashable. (consider-using-in)
************* Module bnsyn.provenance.manifest_builder
src/bnsyn/provenance/manifest_builder.py:73:0: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)
src/bnsyn/provenance/manifest_builder.py:109:0: R0917: Too many positional arguments (6/5) (too-many-positional-arguments)
************* Module bnsyn.connectivity.sparse
src/bnsyn/connectivity/sparse.py:257:0: C0325: Unnecessary parens after 'not' keyword (superfluous-parens)
************* Module bnsyn.viz.interactive
src/bnsyn/viz/interactive.py:32:0: R0914: Too many local variables (33/15) (too-many-locals)
src/bnsyn/viz/interactive.py:86:12: C0415: Import outside toplevel (bnsyn.config.AdExParams, bnsyn.config.CriticalityParams, bnsyn.config.SynapseParams) (import-outside-toplevel)
src/bnsyn/viz/interactive.py:87:12: C0415: Import outside toplevel (bnsyn.rng.seed_all) (import-outside-toplevel)
src/bnsyn/viz/interactive.py:88:12: C0415: Import outside toplevel (bnsyn.sim.network.Network, bnsyn.sim.network.NetworkParams) (import-outside-toplevel)
src/bnsyn/viz/interactive.py:32:0: R0915: Too many statements (63/50) (too-many-statements)
src/bnsyn/viz/interactive.py:215:19: R1735: Consider using '{"size": 2, "color": 'black'}' instead of a call to 'dict'. (use-dict-literal)
src/bnsyn/viz/interactive.py:222:14: R1735: Consider using '{"range": [-1, N]}' instead of a call to 'dict'. (use-dict-literal)
src/bnsyn/viz/interactive.py:173:58: W0613: Unused argument 'duration_ms' (unused-argument)
src/bnsyn/viz/interactive.py:266:21: R1735: Consider using '{"width": 1}' instead of a call to 'dict'. (use-dict-literal)
src/bnsyn/viz/interactive.py:345:4: C0415: Import outside toplevel (plotly.subplots.make_subplots) (import-outside-toplevel)
src/bnsyn/viz/interactive.py:359:71: R1735: Consider using '{"color": 'blue'}' instead of a call to 'dict'. (use-dict-literal)
src/bnsyn/viz/interactive.py:367:74: R1735: Consider using '{"color": 'orange'}' instead of a call to 'dict'. (use-dict-literal)
************* Module bnsyn.viz.dashboard
src/bnsyn/viz/dashboard.py:53:4: W0603: Using the global statement (global-statement)
src/bnsyn/viz/dashboard.py:71:0: R0902: Too many instance attributes (14/7) (too-many-instance-attributes)
************* Module bnsyn.neuron.adex
src/bnsyn/neuron/adex.py:199:0: R0914: Too many local variables (24/15) (too-many-locals)
src/bnsyn/neuron/adex.py:279:0: R0914: Too many local variables (19/15) (too-many-locals)
************* Module bnsyn.memory.ledger
src/bnsyn/memory/ledger.py:92:4: R0917: Too many positional arguments (7/5) (too-many-positional-arguments)
************* Module bnsyn.memory.consolidator
src/bnsyn/memory/consolidator.py:235:8: C0200: Consider using enumerate instead of iterating with range and len (consider-using-enumerate)
************* Module bnsyn.memory.trace
src/bnsyn/memory/trace.py:1:0: R0801: Similar lines in 2 files
==bnsyn.provenance.manifest:[125:131]
==bnsyn.provenance.manifest_builder:[31:37]
    try:
        result = subprocess.run(
            ["git", "rev-parse", "HEAD"],
            capture_output=True,
            text=True,
            check=True, (duplicate-code)
src/bnsyn/memory/trace.py:1:0: R0801: Similar lines in 2 files
==bnsyn.cli:[190:196]
==bnsyn.sim.network:[477:483]
    nparams = NetworkParams(N=N)
    net = Network(
        nparams,
        AdExParams(),
        SynapseParams(),
        CriticalityParams(), (duplicate-code)

------------------------------------------------------------------
Your code has been rated at 9.69/10 (previous run: 9.69/10, +0.00)

mypy src --strict --config-file pyproject.toml
Success: no issues found in 64 source files
pytest -m "not validation" --cov=src/bnsyn --cov-report=html --cov-report=term-missing --cov-fail-under=95
........................................................................ [ 18%]
........................................................................ [ 37%]
.............................................................s....ss.... [ 55%]
........................................................................ [ 74%]
........................................................................ [ 92%]
.............................                                            [100%]
=============================== warnings summary ===============================
tests/test_cli_interactive.py::test_cli_module_main_executes
  <frozen runpy>:128: RuntimeWarning: 'bnsyn.cli' found in sys.modules after import of package 'bnsyn', but prior to execution of 'bnsyn.cli'; this may result in unpredictable behaviour

tests/test_coverage_gap_extensions.py::test_viz_interactive_optional_dependency_errors
  <frozen runpy>:128: RuntimeWarning: 'bnsyn.viz.interactive' found in sys.modules after import of package 'bnsyn.viz', but prior to execution of 'bnsyn.viz.interactive'; this may result in unpredictable behaviour

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.12-final-0 _______________

Name                                        Stmts   Miss  Cover   Missing
-------------------------------------------------------------------------
src/bnsyn/__init__.py                           5      0   100%
src/bnsyn/calibration/__init__.py               3      0   100%
src/bnsyn/calibration/accuracy_speed.py        60      0   100%
src/bnsyn/calibration/fit.py                   22      0   100%
src/bnsyn/cli.py                              183      0   100%
src/bnsyn/config.py                            54      0   100%
src/bnsyn/connectivity/__init__.py              3      0   100%
src/bnsyn/connectivity/sparse.py               71      0   100%
src/bnsyn/consolidation/__init__.py             2      0   100%
src/bnsyn/consolidation/dual_weight.py         32      0   100%
src/bnsyn/control.py                            5      0   100%
src/bnsyn/criticality/__init__.py               4      0   100%
src/bnsyn/criticality/analysis.py              40      0   100%
src/bnsyn/criticality/branching.py             24      0   100%
src/bnsyn/criticality/phase_transition.py      83      0   100%
src/bnsyn/emergence/__init__.py                 2      0   100%
src/bnsyn/emergence/crystallizer.py           198      0   100%
src/bnsyn/energy/__init__.py                    2      0   100%
src/bnsyn/energy/regularization.py             11      0   100%
src/bnsyn/experiments/__init__.py               3      0   100%
src/bnsyn/experiments/declarative.py           43      0   100%
src/bnsyn/incremental.py                       33      0   100%
src/bnsyn/memory/__init__.py                    4      0   100%
src/bnsyn/memory/consolidator.py               93      0   100%
src/bnsyn/memory/ledger.py                     47      0   100%
src/bnsyn/memory/trace.py                      69      0   100%
src/bnsyn/neuron/__init__.py                    2      0   100%
src/bnsyn/neuron/adex.py                      104      0   100%
src/bnsyn/neurons.py                            3      0   100%
src/bnsyn/numerics/__init__.py                  2      0   100%
src/bnsyn/numerics/integrators.py              19      0   100%
src/bnsyn/plasticity/__init__.py                3      0   100%
src/bnsyn/plasticity/stdp.py                    9      0   100%
src/bnsyn/plasticity/three_factor.py           35      0   100%
src/bnsyn/production/__init__.py                3      0   100%
src/bnsyn/production/adex.py                   52      0   100%
src/bnsyn/production/connectivity.py           18      0   100%
src/bnsyn/production/jax_backend.py            27      0   100%
src/bnsyn/provenance/__init__.py                2      0   100%
src/bnsyn/provenance/manifest.py               75      0   100%
src/bnsyn/provenance/manifest_builder.py       49      0   100%
src/bnsyn/rng.py                               21      0   100%
src/bnsyn/schemas/__init__.py                   3      0   100%
src/bnsyn/schemas/experiment.py                26      0   100%
src/bnsyn/sim/__init__.py                       2      0   100%
src/bnsyn/sim/network.py                      186      0   100%
src/bnsyn/simulation.py                         3      0   100%
src/bnsyn/sleep/__init__.py                     3      0   100%
src/bnsyn/sleep/cycle.py                      124      0   100%
src/bnsyn/sleep/replay.py                      29      0   100%
src/bnsyn/sleep/stages.py                      24      0   100%
src/bnsyn/synapse/__init__.py                   2      0   100%
src/bnsyn/synapse/conductance.py               53      0   100%
src/bnsyn/synapses.py                           3      0   100%
src/bnsyn/temperature/__init__.py               2      0   100%
src/bnsyn/temperature/schedule.py              22      0   100%
src/bnsyn/testing/__init__.py                   2      0   100%
src/bnsyn/testing/faults.py                    80      0   100%
src/bnsyn/validation/__init__.py                3      0   100%
src/bnsyn/validation/inputs.py                 47      0   100%
src/bnsyn/vcg.py                               31      0   100%
src/bnsyn/viz/__init__.py                       2      0   100%
src/bnsyn/viz/dashboard.py                    166      0   100%
src/bnsyn/viz/interactive.py                  125      0   100%
-------------------------------------------------------------------------
TOTAL                                        2458      0   100%
Coverage HTML written to dir htmlcov
Required test coverage of 95% reached. Total coverage: 100.00%
386 passed, 3 skipped, 98 deselected, 2 warnings in 78.14s (0:01:18)
Coverage report: htmlcov/index.html
python -m scripts.validate_bibliography
OK: bibliography SSOT validated.
  Bibkeys: 31
  Mapping entries: 26
  Claim IDs: 26
  Lock entries: 31
python -m scripts.validate_claims
[claims-gate] OK: 26 claims validated; 22 normative.
python -m scripts.scan_normative_tags
OK: normative tag scan passed.
gitleaks detect --redact --verbose --source=.

    ○
    │╲
    │ ○
    ○ ░
    ░    gitleaks

1:39AM INF 234 commits scanned.
1:39AM INF scanned ~5188377 bytes (5.19 MB) in 838ms
1:39AM INF no leaks found
pip-audit --desc
No known vulnerabilities found
Name  Skip Reason
----- --------------------------------------------------------------------
bnsyn Dependency not found on PyPI and could not be audited: bnsyn (0.2.0)
bandit -r src/ -ll
[main]	INFO	profile include tests: None
[main]	INFO	profile exclude tests: None
[main]	INFO	cli include tests: None
[main]	INFO	cli exclude tests: None
[main]	INFO	running on Python 3.12.12
Working... ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 100% 0:00:00
Run started:2026-01-31 01:39:51.505843

Test results:
	No issues identified.

Code scanned:
	Total lines of code: 7549
	Total lines skipped (#nosec): 0
	Total potential issues skipped due to specifically being disabled (e.g., #nosec BXXX): 0

Run metrics:
	Total issues (by severity):
		Undefined: 0
		Low: 10
		Medium: 0
		High: 0
	Total issues (by confidence):
		Undefined: 0
		Low: 0
		Medium: 0
		High: 10
Files skipped (0):
✅ All checks passed
